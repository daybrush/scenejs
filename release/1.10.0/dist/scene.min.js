/*
Copyright (c) 2016 Daybrush
name: scenejs
license: MIT
author: Daybrush
repository: https://github.com/daybrush/scenejs.git
version: 1.10.0
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Scene=e()}(this,(function(){"use strict";var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};function e(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return r=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},r.apply(this,arguments)};function n(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}var i="rgba",o="hsla",a=["rgb",i,"hsl",o],s="function",u="property",c="array",f="object",h="string",p="undefined",l=typeof window!==p,v=typeof document!==p&&document,d=["webkit","ms","moz","o"],m=function(t){if(!v)return"";var e=(v.body||v.documentElement).style,r=d.length;if(typeof e[t]!==p)return t;for(var n=0;n<r;++n){var i="-"+d[n]+"-"+t;if(typeof e[i]!==p)return i}return""},g=m("transform"),y=m("filter"),E=m("animation"),_=E.replace("animation","keyframes"),b=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}];function O(t,e,r,n){return(t*n+e*r)/(r+n)}function S(t){return typeof t===p}function T(t){return t&&typeof t===f}function w(t){return Array.isArray(t)}function C(t){return typeof t===h}function x(t){return typeof t===s}function M(t,e,r,n,i){return j(t,e,r)?r:function(t,e,r,n,i){for(var o,a=function(r){var a=e[r].trim();if(a===t.close&&!j(t,e,r))return{value:r};var s=r,u=V(i,(function(t){return t.open===a}));if(u&&(s=M(u,e,r,n,i)),-1===s)return o=r,"break";o=r=s},s=r;s<n;++s){var u=a(s);if(s=o,"object"==typeof u)return u.value;if("break"===u)break}return-1}(t,e,r+1,n,i)}function j(t,e,r){if(!t.ignore)return null;var n=e.slice(Math.max(r-3,0),r+3).join("");return new RegExp(t.ignore).exec(n)}function I(t,e){var r=C(e)?{separator:e}:e,n=r.separator,i=void 0===n?",":n,o=r.isSeparateFirst,a=r.isSeparateOnlyOpenClose,s=r.isSeparateOpenClose,u=void 0===s?a:s,c=r.openCloseCharacters,f=void 0===c?b:c,h=f.map((function(t){var e=t.open,r=t.close;return e===r?e:e+"|"+r})).join("|"),p=new RegExp("(\\s*"+i+"\\s*|"+h+"|\\s+)","g"),l=t.split(p).filter(Boolean),v=l.length,d=[],m=[];function g(){return!!m.length&&(d.push(m.join("")),m=[],!0)}for(var y,E=function(e){var r=l[e].trim(),n=e,s=V(f,(function(t){return t.open===r})),c=V(f,(function(t){return t.close===r}));if(s){if(-1!==(n=M(s,l,e,v,f))&&u)return g()&&o?(y=e,"break"):(d.push(l.slice(e,n+1).join("")),e=n,o?(y=e,"break"):(y=e,"continue"))}else{if(c&&!j(c,l,e)){var h=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}(f);return h.splice(f.indexOf(c),1),{value:I(t,{separator:i,isSeparateFirst:o,isSeparateOnlyOpenClose:a,isSeparateOpenClose:u,openCloseCharacters:h})}}if(function(t,e){return(""===e||" "==e)&&(""===t||" "==t)||t===e}(r,i)&&!a)return g(),o?(y=e,"break"):(y=e,"continue")}-1===n&&(n=v-1),m.push(l.slice(e,n+1).join("")),y=e=n},_=0;_<v;++_){var O=E(_);if(_=y,"object"==typeof O)return O.value;if("break"===O)break}return m.length&&d.push(m.join("")),d}function F(t){return I(t,",")}function A(t){var e=/([^(]*)\(([\s\S]*)\)([\s\S]*)/g.exec(t);return!e||e.length<4?{}:{prefix:e[1],value:e[2],suffix:e[3]}}function D(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var r=e[1],n=e[2];return{prefix:r,unit:e[3],value:parseFloat(n)}}function N(t){return t.replace(/[\s-_]([a-z])/g,(function(t,e){return e.toUpperCase()}))}function R(t,e){return void 0===e&&(e="-"),t.replace(/([a-z])([A-Z])/g,(function(t,r,n){return""+r+e+n.toLowerCase()}))}function P(t){return[].slice.call(t)}function U(){return Date.now?Date.now():(new Date).getTime()}function k(t,e,r){void 0===r&&(r=-1);for(var n=t.length,i=0;i<n;++i)if(e(t[i],i,t))return i;return r}function V(t,e,r){var n=k(t,e);return n>-1?t[n]:r}var H=function(){var t=U(),e=l&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame);return e?e.bind(window):function(e){var r=U();return setTimeout((function(){e(r-t)}),1e3/60)}}(),z=function(){var t=l&&(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.msCancelAnimationFrame);return t?t.bind(window):function(t){clearTimeout(t)}}();function L(t){return Object.keys(t)}function B(t,e){void 0===e&&(e=[]),t.sort((function(t,r){var n=e.indexOf(t),i=e.indexOf(r);return-1===i&&-1===n?0:-1===n?1:-1===i?-1:n-i}))}function $(t){var e=function(t){return t.replace("#","")}(t),r=parseInt(e.substring(0,2),16),n=parseInt(e.substring(2,4),16),i=parseInt(e.substring(4,6),16),o=parseInt(e.substring(6,8),16)/255;return isNaN(o)&&(o=1),[r,n,i,o]}function q(t){if("#"===t.charAt(0))return 4===t.length||5===t.length?$((h=(f=t).charAt(1),p=f.charAt(2),l=f.charAt(3),v=f.charAt(4),["#",h,h,p,p,l,l,v,v].join(""))):$(t);if(-1!==t.indexOf("(")){var e=A(t),r=e.prefix,n=e.value;if(!r||!n)return;var a=F(n),s=[0,0,0,1],u=a.length;switch(r){case"rgb":case i:for(var c=0;c<u;++c)s[c]=parseFloat(a[c]);return s;case"hsl":case o:for(c=0;c<u;++c)-1!==a[c].indexOf("%")?s[c]=parseFloat(a[c])/100:s[c]=parseFloat(a[c]);return function(t){var e,r=t[0],n=t[1],i=t[2];r<0&&(r+=360*Math.floor((Math.abs(r)+360)/360)),r%=360;var o,a=(1-Math.abs(2*i-1))*n,s=a*(1-Math.abs(r/60%2-1)),u=i-a/2;return o=r<60?[a,s,0]:r<120?[s,a,0]:r<180?[0,a,s]:r<240?[0,s,a]:r<300?[s,0,a]:r<360?[a,0,s]:[0,0,0],[Math.round(255*(o[0]+u)),Math.round(255*(o[1]+u)),Math.round(255*(o[2]+u)),null!==(e=t[3])&&void 0!==e?e:1]}(s)}}var f,h,p,l,v}function K(t,e){return v?e?v.querySelectorAll(t):v.querySelector(t):e?[]:null}function Z(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function W(t,e){if(t.classList)t.classList.remove(e);else{var r=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(r," ")}}function Y(t,e,r,n){t.addEventListener(e,r,n)}function J(t,e,r,n){t.removeEventListener(e,r,n)}function X(t,e,r){var n=1-r;return r*r*r+3*r*r*n*e+3*r*n*n*t}function G(t,e,r,n){var i=function(i){var o,a,s,u=function(t,e,r){for(var n=r,i=1;Math.abs(i)>.001;){if(i=X(t,e,n)-r,Math.abs(i)<.001)return n;n-=i/2}return n}(t,r,(o=i,a=0,s=1,Math.max(a,Math.min(o,s))));return X(e,n,u)};return i.easingName="cubic-bezier(".concat(t,",").concat(e,",").concat(r,",").concat(n,")"),i}function Q(t,e){var r=function(r){var n=1/t;return r>=1?1:("start"===e?n:0)+Math.floor(r/n)*n};return r.easingName="steps(".concat(t,", ").concat(e,")"),r}var tt,et=Q(1,"start"),rt=Q(1,"end"),nt=G(0,0,1,1),it=G(.25,.1,.25,1),ot=G(.42,0,1,1),at=G(0,0,.58,1),st=G(.42,0,.58,1),ut="__SCENEJS_",ct="data-scene-id",ft="animation-timing-function",ht={transform:{},filter:{},attribute:{},html:!0},pt={easing:[ft]},lt=((tt={})[ft]=!0,tt.contents=!0,tt.html=!0,tt),vt=1e6,dt=1e-6,mt="duration",gt="fillMode",yt="direction",Et="iterationCount",_t="delay",bt="easing",Ot="playSpeed",St="easingName",Tt="paused",wt="ended",Ct="timeupdate",xt="play",Mt="running",jt="iteration",It="startAnimation",Ft="pauseAnimation",At="alternate",Dt="reverse",Nt="alternate-reverse",Rt="infinite",Pt="playState",Ut="playCSS",kt="prevTime",Vt="tickTime",Ht="currentTime",zt="selector",Lt="transform",Bt={linear:nt,ease:it,"ease-in":ot,"ease-out":at,"ease-in-out":st,"step-start":et,"step-end":rt},$t="_///_",qt=[mt,gt,yt,Et,_t,bt,Ot],Kt=[Tt,wt,Ct,"animate",xt,jt],Zt=function(){function t(t,e){this.prefix="",this.suffix="",this.model="",this.type="",this.separator=",",e&&this.setOptions(e),this.value=C(t)?t.split(this.separator):t}return t.prototype.setOptions=function(t){for(var e in t)this[e]=t[e];return this},t.prototype.size=function(){return this.value.length},t.prototype.get=function(t){return this.value[t]},t.prototype.set=function(t,e){return this.value[t]=e,this},t.prototype.clone=function(){var e=this,r=e.separator,n=e.prefix,i=e.suffix,o=e.model,a=e.type;return new t(this.value.map((function(t){return me(t)?t.clone():t})),{separator:r,prefix:n,suffix:i,model:o,type:a})},t.prototype.toValue=function(){return this.prefix+this.join()+this.suffix},t.prototype.join=function(){return this.value.map((function(t){return me(t)?t.toValue():t})).join(this.separator)},t.prototype.forEach=function(t){return this.value.forEach(t),this},t}();function Wt(t){for(var e=I(t,";"),r={},n=e.length,i=n,o=0;o<n;++o){var a=I(e[o],":");a.length<2||!a[1]?--i:r[a[0].trim()]=Xt(a[1].trim())}return{styles:r,length:i}}function Yt(t){var e=i;return 3===t.length&&(t[3]=1),new Zt(t,{model:e,separator:",",type:"color",prefix:"".concat(e,"("),suffix:")"})}function Jt(t,e){return new Zt(t,{type:"array",separator:e})}function Xt(t,e){if(!C(t))return w(t)?Jt(t,","):t;var r=F(t);return r.length>1?Jt(r.map((function(t){return Xt(t)})),","):(r=I(t,"")).length>1?Jt(r.map((function(t){return Xt(t)}))," "):(r=/^(['"])([^'"]*)(['"])$/g.exec(t))&&r[1]===r[3]?new Zt([Xt(r[2])],{prefix:r[1],suffix:r[1]}):-1!==t.indexOf("(")?function(t){var e=A(t),r=e.prefix,n=e.value,i=e.suffix;if(void 0===n)return t;if(a.indexOf(r)>-1)return Yt(q(t));var o=Xt(n,r),s=[n],u=",",c="".concat(r,"("),f=")".concat(i);return me(o)&&(u=o.separator,s=o.value,c+=o.prefix,f=o.suffix+f),new Zt(s,{separator:u,model:r,prefix:c,suffix:f})}(t):"#"===t.charAt(0)&&"url"!==e?function(t){var e=q(t);return e?Yt(e):t}(t):t}function Gt(t,e){void 0===e&&(e={});var r=t.model;if(r){t.setOptions({model:"",suffix:"",prefix:""});var n=t.size()>1?t:t.get(0);e[r]=n}else t.forEach((function(t){Gt(t,e)}));return e}function Qt(t){var e=typeof t;if(e===f){if(w(t))return c;if(me(t))return u}else if(e===h||"number"===e)return"value";return e}function te(t){return T(t)&&t.constructor===Object}function ee(t,e){var r=[];if(te(t))for(var n in t)e.push(n),r=r.concat(ee(t[n],e)),e.pop();else r.push(e.slice());return r}function re(t,e){for(var r in e){te(e[r])?(T(t[r])||(t[r]={}),re(t[r],e[r])):t[r]=!0}return t}function ne(t){return Math.round(t*vt)/vt}function ie(t,e,r){void 0===r&&(r=t.length);for(var n=e,i=0;i<r;++i){if(!T(n)||null==n)return;n=n[t[i]]}return n}function oe(t,e,r){var n=e.length,i=t;if(0===n)return!1;for(var o=0;o<n;++o){if(!0===i)return!1;if(!(i=i[e[o]])||!r&&!0===i)return!1}return!0}function ae(t,e){return oe(ht,t,e)}function se(t){return oe(lt,t,!0)}function ue(t,e){t.state[Ut]=e}function ce(t){return t.state[Ut]&&t.isPaused()}function fe(t){return!t.isEnded()&&t.state[Ut]}function he(t){for(;;){var e="".concat(Math.floor(1e7*Math.random()));if(!l||!t)return e;if(!K('[data-scene-id="'.concat(e,'"]')))return e}}function pe(t){return t.getId()||t.setId(he(!1)).getId()}function le(t){return"".concat(t).match(/[0-9a-zA-Z]+/g).join("")}function ve(t,e,r,n){if(void 0===n&&(n={}),E&&t.getPlayState()!==Mt){var i=r||It;if(ce(t))t.addPlayClass(!0,i,n);else{t.isEnded()&&t.setTime(0),e&&t.exportCSS({className:i});var o=t.addPlayClass(!1,i,n);if(!o)return;!function(t,e){var r=t.state,n=t.getDuration(),i=!n||!isFinite(n),o=function(){ue(t,!1),t.finish()},a=function(){t.trigger(xt),Y(e,"animationcancel",o),Y(e,"animationend",o),Y(e,"animationiteration",s)};t.once(wt,(function(){J(e,"animationcancel",o),J(e,"animationend",o),J(e,"animationiteration",s),J(e,"animationstart",a)}));var s=function(e){var o=e.elapsedTime,a=i?0:o/n;r[Ht]=o,t.setIteration(a)};Y(e,"animationstart",a)}(t,o),ue(t,!0)}t.setPlayState(Mt)}}function de(t){var e;if(C(t))if(t in Bt)e=Bt[t];else{var r=Xt(t);if(C(r))return 0;if("cubic-bezier"===r.model)e=G((t=r.value.map((function(t){return parseFloat(t)})))[0],t[1],t[2],t[3]);else{if("steps"!==r.model)return 0;e=Q(parseFloat(r.value[0]),r.value[1])}}else e=w(t)?G(t[0],t[1],t[2],t[3]):t;return e}function me(t){if(!t)return!1;var e=t.constructor.prototype;return!!(e.clone&&e.get&&e.setOptions)}function ge(t){return t&&!!t.constructor.prototype.getItem}function ye(t){return t&&!!t.constructor.prototype.getFrame}function Ee(t){return t&&!!t.constructor.prototype.toCSSText}function _e(t,e){var r={};for(var n in t){var i=t[n];if(Ee(i))r[n]=i;else if(T(i)){var o=_e(i,e);for(var a in o)r["".concat(n).concat(e).concat(a)]=o[a]}}return r}function be(t){var e=A(t);if(0!==(e.prefix||"").indexOf("rgb"))return{hex:"",opacity:1};var r=F(e.value),n=r.slice(0,3).map((function(t){return parseInt(t,10).toString(16)}));return{hex:"#".concat(n.join("")),opacity:r[3]?parseFloat(r[3]):1}}var Oe=function(){return Oe=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Oe.apply(this,arguments)};var Se=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(T(t))for(var r in t)this.on(r,t[r]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(T(t))for(var r in t)this.off(r);else if(e){var n=this._events[t];if(n){var i=k(n,(function(t){return t.listener===e}));i>-1&&n.splice(i,1)}}else this._events[t]=[];else this._events={};return this},e.once=function(t,e){var r=this;return e&&this._addEvent(t,e,{once:!0}),new Promise((function(e){r._addEvent(t,e,{once:!0})}))},e.emit=function(t,e){var r=this;void 0===e&&(e={});var n=this._events[t];if(!t||!n)return!0;var i=!1;return e.eventType=t,e.stop=function(){i=!0},e.currentTarget=this,function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n}(n).forEach((function(n){n.listener(e),n.once&&r.off(t,n.listener)})),!i},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,r){var n=this._events;n[t]=n[t]||[],n[t].push(Oe({listener:e},r))},t}(),Te=Se;function we(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ce(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(t){i={error:t}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function xe(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ce(arguments[e]));return t}var Me=function(t){return void 0===t},je=function(){function t(t,e){var r,n;if(this._canceled=!1,e)try{for(var i=we(Object.keys(e)),o=i.next();!o.done;o=i.next()){var a=o.value;this[a]=e[a]}}catch(t){r={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}this.eventType=t}var e=t.prototype;return e.stop=function(){this._canceled=!0},e.isCanceled=function(){return this._canceled},t}(),Ie=function(){function t(){this._eventHandler={}}var e=t.prototype;return e.trigger=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=t instanceof je?t.eventType:t,i=xe(this._eventHandler[n]||[]);return i.length<=0||(t instanceof je?(t.currentTarget=this,i.forEach((function(e){e(t)}))):i.forEach((function(t){t.apply(void 0,xe(e))}))),this},e.once=function(t,e){var r=this;if("object"==typeof t&&Me(e)){var n=t;for(var i in n)this.once(i,n[i]);return this}if("string"==typeof t&&"function"==typeof e){var o=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];e.apply(void 0,xe(n)),r.off(t,o)};this.on(t,o)}return this},e.hasOn=function(t){return!!this._eventHandler[t]},e.on=function(t,e){if("object"==typeof t&&Me(e)){var r=t;for(var n in r)this.on(n,r[n]);return this}if("string"==typeof t&&"function"==typeof e){var i=this._eventHandler[t];Me(i)&&(this._eventHandler[t]=[],i=this._eventHandler[t]),i.push(e)}return this},e.off=function(t,e){var r,n;if(Me(t))return this._eventHandler={},this;if(Me(e)){if("string"==typeof t)return delete this._eventHandler[t],this;var i=t;for(var o in i)this.off(o,i[o]);return this}var a=this._eventHandler[t];if(a){var s=0;try{for(var u=we(a),c=u.next();!c.done;c=u.next()){if(c.value===e){a.splice(s,1),a.length<=0&&delete this._eventHandler[t];break}s++}}catch(t){r={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}return this},t.VERSION="3.0.4",t}();function Fe(t){return Object.keys(t)}var Ae="__observers__",De="__CFCS_DETECTED_DEPENDENCIES__",Ne=function(t,e){return Ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},Ne(t,e)};function Re(){Object[De]=Object[De]||{};var t=Object[De];return t[1]=t[1]||[],t[1]}var Pe=function(){function t(t){this._emitter=new Ie,this._current=t}var e=t.prototype;return Object.defineProperty(e,"current",{get:function(){var t,e=(t=Re())[t.length-1];return null==e||e.push(this),this._current},set:function(t){this._setCurrent(t)},enumerable:!1,configurable:!0}),e.subscribe=function(t){return this.current,this._emitter.on("update",t),this},e.unsubscribe=function(t){return this._emitter.off("update",t),this},e._setCurrent=function(t){var e=this._current,r=t!==e;this._current=t,r&&this._emitter.trigger("update",t,e)},e.toString=function(){return"".concat(this.current)},e.valueOf=function(){return this.current},t}(),Ue=function(t){function e(e){var r=t.call(this)||this;return r._computedCallback=e,r._registered=[],r._onCheckUpdate=function(){r._setCurrent(r.current)},r._current=r.current,r}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}Ne(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t);var r=e.prototype;return Object.defineProperty(r,"current",{get:function(){var t,e,r,n,i=this;t=this,e=Re(),n={host:t,observers:r=[],push:function(e){t!==e&&-1===r.indexOf(e)&&r.push(e)}},e.push(n);var o=this._computedCallback(),a=Re().pop();return this._registered.forEach((function(t){t.unsubscribe(i._onCheckUpdate)})),a.observers.forEach((function(t){t.subscribe(i._onCheckUpdate)})),this._registered=a.observers,o},enumerable:!1,configurable:!0}),e}(Pe);function ke(t,e,r){void 0===r&&(r=e);var n={configurable:!0,get:function(){return qe(this,r).current},set:function(t){qe(this,r,t).current=t}};Object.defineProperty(t,e,n),r!==e&&Object.defineProperty(t,r,{configurable:!0,get:function(){return qe(this,r).current}})}function Ve(t,e){var r,n="function"==typeof t?t():t,i={};return Be(i),Fe(n).forEach((function(t){var e=n[t];Ze(e)?Ke(i,t,e):Ke(i,t,ze(e)),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.length>1?ke(t[0],t[1]):function(e,r){return ke(e,r,t[0])}}(t)(i,t)})),(r=i).subscribe=function(t,e){this[t],qe(this,t).subscribe(e)},r.unsubscribe=function(t,e){var r=this;t?t in this&&qe(this,t).unsubscribe(e):Fe($e(this)).forEach((function(t){r.unsubscribe(t)}))},i}function He(t){return Ve(t)}function ze(t){return new Pe(t)}function Le(t){return new Ue(t)}function Be(t){var e={};return Object.defineProperty(t,Ae,{get:function(){return e}}),e}function $e(t,e){var r,n;t[Ae]||Be(t);var i=t[Ae];if(!e){var o=null===(n=null===(r=null==t?void 0:t.constructor)||void 0===r?void 0:r.prototype)||void 0===n?void 0:n.__computed__;o&&o.forEach((function(e){!(e in i)&&e in t&&t[e]}))}return i}function qe(t,e,r){var n=$e(t);return n[e]||(n[e]=ze(r)),n[e]}function Ke(t,e,r){$e(t)[e]=r}function Ze(t){return t&&function(t){return"object"==typeof t}(t)&&"current"in t&&"subscribe"in t&&"unsubscribe"in t}function We(t,e,r){return r===Dt||(e!==Rt&&t===e&&e%1==0?r===(t%2>=1?Nt:At):r===(t%2>=1?At:Nt))}var Ye=["id",Et,_t,gt,yt,Ot,mt,Ot,"iterationTime",Pt],Je=n(n([],Ye,!0),[bt,St],!1),Xe=function(t){function r(e){var r=t.call(this)||this;return r.timerId=0,r.state=Ve({id:"",easing:0,easingName:"linear",iterationCount:1,delay:0,fillMode:"forwards",direction:"normal",playSpeed:1,currentTime:0,iterationTime:-1,iteration:0,tickTime:0,prevTime:0,playState:Tt,duration:0}),r.setOptions(e),r}var n,i,o;return e(r,t),r.prototype.setEasing=function(t){var e=de(t),r=e&&e[St]||"linear",n=this.state;return n[bt]=e,n[St]=r,this},r.prototype.setOptions=function(t){for(var e in void 0===t&&(t={}),t){var r=t[e];e!==bt?e!==mt?qt.indexOf(e)>-1&&(this.state[e]=r):r&&this.setDuration(r):this.setEasing(r)}return this},r.prototype.getTotalDuration=function(){return this.getActiveDuration(!0)},r.prototype.getActiveDuration=function(t){var e=this.state,r=e[Et];return r===Rt?1/0:(t?e[_t]:0)+this.getDuration()*r},r.prototype.isEnded=function(){return 0===this.state[Vt]&&this.state[Pt]===Tt||!(this.getTime()<this.getActiveDuration())},r.prototype.isPaused=function(){return this.state[Pt]===Tt},r.prototype.start=function(t){void 0===t&&(t=this.state[_t]);var e=this.state;return e[Pt]=Mt,e[Vt]>=t&&(this.trigger(xt),!0)},r.prototype.play=function(t){var e=this,r=this.state,n=r[_t],i=this.getTime();return r[Pt]=Mt,this.isEnded()&&(0===i||i>=this.getActiveDuration())&&this.setTime(-n,!0),this.timerId=H((function(n){r[kt]=n,e.tick(n,t)})),this.start(),this},r.prototype.pause=function(){var t=this.state;return t[Pt]!==Tt&&(t[Pt]=Tt,this.trigger(Tt)),z(this.timerId),this},r.prototype.finish=function(){return this.setTime(0),this.state[Vt]=0,this.end(),this},r.prototype.end=function(){return this.pause(),this.trigger(wt),this},r.prototype.setTime=function(t,e,r,n){var i=this.getActiveDuration(),o=this.state,a=o[Vt],s=o[_t],u=e?t:this.getUnitTime(t);o[Vt]=s+u,u<0?u=0:u>i&&(u=i),o[Ht]=u,this.calculate();var c=e&&!r,f=o[Vt],h=C(t)?parseFloat(t):t;return c&&a<s&&h>=0&&this.start(0),null==n||n(),c&&(f<a||this.isEnded())?(this.end(),this):(this.isDelay()||this.trigger(Ct,{currentTime:u,time:this.getIterationTime(),iterationCount:o[jt]}),this)},r.prototype.getTime=function(){return this.state[Ht]},r.prototype.getUnitTime=function(t){if(C(t)){var e=this.getDuration()||100;if("from"===t)return 0;if("to"===t)return e;var r=D(t),n=r.unit,i=r.value;return"%"===n?(!this.getDuration()&&this.setDuration(e),ne(parseFloat(t)/100*e)):">"===n?i+dt:i}return ne(t)},r.prototype.isDelay=function(){var t=this.state,e=t[_t],r=t[Vt];return e>0&&r<e},r.prototype.setIteration=function(t){var e=this.state,r=Math.floor(t),n=e[Et]===Rt?1/0:e[Et];return e[jt]<r&&r<n&&this.trigger(jt,{currentTime:e[Ht],iterationCount:r}),e[jt]=t,this},r.prototype.calculate=function(){var t=this.state,e=t[Et],r=t[gt],n=t[yt],i=this.getDuration(),o=this.getTime(),a=0===i?0:o/i,s=i?o%i:0;if(!i)return this.setIterationTime(0),this;this.setIteration(a);var u=We(a,e,n),c=isFinite(i);(c&&u&&(s=i-s),c&&e!==Rt)&&(a>=e&&(s=i*("both"===r||"forwards"===r?e%1||1:0),u&&(s=i-s)));return this.setIterationTime(s),this},r.prototype.tick=function(t,e){var r=this;if(!this.isPaused()){var n=this.state,i=n[Ot],o=n[kt],a=n[_t],s=n[Vt]+Math.min(1e3,t-o)/1e3*i;n[kt]=t,e&&e>=s?(this.setTime(e-a,!0),this.pause()):this.setTime(s-a,!0),n[Pt]!==Tt&&(this.timerId=H((function(t){r.tick(t,e)})))}},r=function(t,e,r,n){var i,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,r,a):i(e,r))||a);return o>3&&a&&Object.defineProperty(e,r,a),a}([(n=Je,i=Ye,o="state",function(t){var e=t.prototype;n.forEach((function(t){e[N("get ".concat(t))]=function(){return this[o][t]}})),i.forEach((function(t){e[N("set ".concat(t))]=function(e){return this[o][t]=e,this}}))})],r),r}(Te),Ge=function(){function t(t){this.separator=t,this.orderMap={}}var e=t.prototype;return e.getFullName=function(t){return t.join(this.separator)},e.get=function(t){return this.orderMap[this.getFullName(t)]},e.gets=function(t,e){void 0===e&&(e=!0);var r=[],n=this;return function t(e,i){var o=n.get(e);if(o)return o.forEach((function(n){var o=i.concat([n]),a=t(e.concat([n]),o);a&&a.length||r.push(i.concat([n]))})),o}(t,e?t:[]),r},e.set=function(t,e){var r=this;return t.forEach((function(e,n){r.addName(t.slice(0,n),e)})),this.orderMap[this.getFullName(t)]=e,e},e.add=function(t){var e=t.length;return e?this.addName(t.slice(0,-1),t[e-1]):[]},e.addName=function(t,e){var r=this.get(t)||this.set(t,[]);return-1===r.indexOf(e)&&r.push(e),r},e.findIndex=function(t,e){var r=this.orderMap[this.getFullName(t)];return r?r.indexOf(e):-1},e.remove=function(t){var e=this.getFullName(t),r=this.orderMap;for(var n in r)0===n.indexOf(e)&&delete r[n];var i=t.length;if(i){var o=t.slice(0,-1),a=t[i-1];this.splice(o,this.findIndex(o,a),1)}return this},e.filter=function(e,r,n){void 0===n&&(n=!0);var i=this.gets(e,n).filter(r),o=new t(this.separator),a=n?[]:e;return i.forEach((function(t){o.add(a.concat(t))})),o},e.splice=function(t,e,r){for(var n=[],i=3;i<arguments.length;i++)n[i-3]=arguments[i];var o=this.get(t)||this.set(t,[]);return o.splice.apply(o,[e,r].concat(n)),this},e.clear=function(){this.orderMap={}},e.setObject=function(t){var e=this.orderMap;for(var r in t)e[r]=t[r].slice()},e.getObject=function(){var t={},e=this.orderMap;for(var r in e)t[r]=e[r].slice();return t},e.clone=function(){var e=new t(this.separator);return e.setObject(e.orderMap),e},t}(),Qe=Ge;function tr(t,e){if(void 0===e&&(e=[]),!t)return"";var r=[],n=L(t);return B(n,e),n.forEach((function(e){r.push("".concat(e.replace(/\d$/g,""),"(").concat(t[e],")"))})),r.join(" ")}function er(t,e){return void 0===e&&(e=!1),rr({},t,e)}function rr(t,e,r){for(var n in void 0===r&&(r=!1),e){var i=e[n],o=Qt(i);o===u?t[n]=r?i.toValue():i.clone():o===s?t[n]=r?ir([n],i):i:o===c?t[n]=i.slice():o===f?T(t[n])&&!me(t[n])?rr(t[n],i,r):t[n]=er(i,r):t[n]=e[n]}return t}function nr(t){return t[0]in pt?pt[t[0]]:t}function ir(t,e){var r=Qt(e);if(r===u)return e.toValue();if(r===s){if(t[0]!==ft)return ir(t,e())}else if(r===f)return er(e,!0);return e}var or=function(t){function r(e){void 0===e&&(e={});var r=t.call(this)||this;return r.properties={},r.orderMap=new Qe($t),r.properties={},r.set(e),r}return e(r,t),r.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.raw.apply(this,t);return ir(nr(t),r)},r.prototype.getOrders=function(t){return this.orderMap.get(t)},r.prototype.setOrders=function(t,e){var r=this.orderMap.set(t,e);return this._update(),r},r.prototype.getOrderObject=function(){return this.orderMap.getObject()},r.prototype.setOrderObject=function(t){this.orderMap.setObject(t),this._update()},r.prototype.getKeys=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this.raw.apply(this,t),n=Qt(r)===f?L(r):[];return B(n,this.orderMap.get(t)),n},r.prototype.gets=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=this.get.apply(this,e),o=this.getKeys.apply(this,e);return o.map((function(r){return{key:r,value:i[r],children:t.gets.apply(t,n(n([],e,!1),[r],!1))}}))},r.prototype.raw=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ie(nr(t),this.properties)},r.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=nr(t),n=r.length;if(!n)return this;this.orderMap.remove(r);var i=ie(r,this.properties,n-1);return T(i)&&delete i[r[n-1]],this._update(),this},r.prototype.set=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._set.apply(this,t),this._update(),this},r.prototype.getNames=function(){return ee(this.properties,[])},r.prototype.has=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=nr(t),n=r.length;return!!n&&!S(ie(r,this.properties,n))},r.prototype.clone=function(){var t=new r;return t.setOrderObject(this.orderMap.orderMap),t.merge(this)},r.prototype.merge=function(t){var e=this.properties,r=t.properties;return r&&rr(e,r),this},r.prototype.toCSSObject=function(t){var e=this.get(),r={};for(var n in e)if(!ae([n],!0)){var i=e[n];n===ft&&(n=ft.replace("animation",E),i=(C(i)?i:i[St])||"initial"),t&&(n=N(n.replace(/^[-]+/g,""))),r[n]=i}var o=tr(e[Lt],this.orderMap.get([Lt])),a=tr(e.filter,this.orderMap.get([y]));return g&&o&&(r[g]=o),y&&a&&(r[y]=a),r},r.prototype.toCSSText=function(){var t=this.toCSSObject(),e=[],r=L(t);return B(r,this.orderMap.get([])),r.forEach((function(r){e.push("".concat(R(r,"-"),":").concat(t[r],";"))})),e.join("")},r.prototype.toCSS=function(){var t=this.toCSSObject(),e=[],r=L(t);return B(r,this.orderMap.get([])),r.forEach((function(r){e.push("".concat(r,":").concat(t[r],";"))})),e.join("")},r.prototype.clear=function(){return this.properties={},this.orderMap.clear(),this},r.prototype._set=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=this,i=t.length,o=t.slice(0,-1),a=t[i-1],s=o[0];if(1===i&&Ee(a))r.merge(a);else if(s in pt)r._setByPath(pt[s],a);else if(2===i&&w(s))r._setByPath(s,a);else if(me(a))ae(o)?r._set.apply(r,n(n([],o,!1),[Gt(a)],!1)):r._setByPath(o,a);else if(w(a))r._setByPath(o,a);else if(T(a))for(var u in!r.has.apply(r,o)&&ae(o)&&r._setByPath(o,{}),a)r._set.apply(r,n(n([],o,!1),[u,a[u]],!1));else if(C(a)){if(ae(o,!0)){if(se(o)||!ae(o))this._setByPath(o,a);else{var c=Xt(a);T(c)&&r._set.apply(r,n(n([],o,!1),[c],!1))}return this}var f=Wt(a),h=f.styles,p=f.length;for(var l in h)r._set.apply(r,n(n([],o,!1),[l,h[l]],!1));if(p)return this;r._setByPath(o,a)}else r._setByPath(o,a)},r.prototype._setByPath=function(t,e){for(var r=this.properties,n=t.length,i=0;i<n-1;++i){var o=t[i];!(o in r)&&(r[o]={}),r=r[o]}if(n){var a=t[n-1];this.orderMap.add(t),r[a]=1===n&&a===ft?de(e):C(e)&&!se(t)?Xt(e,a):e}},r.prototype._update=function(){this.emit("update")},r}(Te);function ar(t,e,r,n){var i=e.length;return t.map((function(t,o){return o>=i?t:ur(t,e[o],r,n)}))}function sr(t,e,r,n){var i=t.type;if("color"===i)return function(t,e,r,n){var i=t.value,o=e.value,a=t.model;if(a!==e.model)return ur(t.toValue(),e.toValue(),r,n);3===i.length&&(i[3]=1),3===o.length&&(o[3]=1);for(var s=ar(i,o,r,n),u=a,c=0;c<3;++c)s[c]=parseInt(s[c],10);return new Zt(s,{type:"color",model:u,prefix:"".concat(u,"("),suffix:")"})}(t,e,r,n);var o=ar(t.value,e.value,r,n);return new Zt(o,{type:i,separator:t.separator||e.separator,prefix:t.prefix||e.prefix,suffix:t.suffix||e.suffix,model:t.model||e.model})}function ur(t,e,r,n){if(0===n)return e;if(0===r||r+n===0)return t;var i=Qt(t),o=Qt(e),a=i===s,f=o===s;if(a||f)return function(){return ur(a?Xt(t()):t,f?Xt(e()):e,r,n)};if(i!==o)return t;if(i===u)return sr(t,e,r,n);if(i===c)return ar(t,e,r,n);if("value"!==i)return t;var h,p=D("".concat(t)),l=D("".concat(e));if(isNaN(p.value)||isNaN(l.value))return t;h=O(p.value,l.value,r,n);var v=p.prefix||l.prefix,d=p.unit||l.unit;return v||d?v+h+d:h}var cr=function(t){for(var e=5381,r=t.length;r;)e=33*e^t.charCodeAt(--r);return e>>>0};function fr(t,e,r,n){var i=document.createElement("style");return i.setAttribute("type","text/css"),i.setAttribute("data-styled-id",t),r.nonce&&i.setAttribute("nonce",r.nonce),i.innerHTML=function(t,e,r){return r.original?e:e.replace(/([^};{\s}][^};{]*|^\s*){/gm,(function(e,r){var n=r.trim();return(n?F(n):[""]).map((function(e){var r=e.trim();return 0===r.indexOf("@")?r:r.indexOf(":global")>-1?r.replace(/\:global/g,""):r.indexOf(":host")>-1?""+r.replace(/\:host/g,"."+t):r?"."+t+" "+r:"."+t})).join(", ")+" {"}))}(t,e,r),(n||document.head||document.body).appendChild(i),i}function hr(t){var e,r="rCS"+cr(t).toString(36),n=0;return{className:r,inject:function(i,o){void 0===o&&(o={});var a,s=function(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(i),u=0===n;return(s||u)&&(a=fr(r,t,o,s)),u&&(e=a),s||++n,{destroy:function(){s?(i.removeChild(a),a=null):(n>0&&--n,0===n&&e&&(e.parentNode.removeChild(e),e=null))}}}}}function pr(t,e){for(var r=t.length,n=0;n<r;++n){if(t[n]===e)return[n,n];if(t[n]>e)return[n>0?n-1:0,n]}return[r-1,r-1]}function lr(t){var e=[];for(var r in t)e.push("".concat(E,"-").concat(R(r),":").concat(t[r],";"));return e.join("")}function vr(t,e,r){var n=t[t.length-1];(!n||n[0]!==e||n[1]!==r)&&t.push([ne(e),ne(r)])}var dr=function(t){function r(e,r){var n=t.call(this)||this;return n.times=[],n.items={},n.nameMap=new Qe($t),n.elements=[],n.needUpdate=!0,n.registeredElement=!1,n.load(e,r),n}return e(r,t),r.prototype.getDuration=function(){var t=this.times,e=t.length;return(0===e?0:t[e-1])||this.state[mt]},r.prototype.size=function(){return this.times.length},r.prototype.setDuration=function(t){if(!t)return this;var e=this.getDuration();if(e>0){var r=t/e,n=this.times,i=this.items,o={};this.times=n.map((function(t){var e=ne(t*r);return o[e]=i[t],e})),this.items=o}else this.newFrame(t);return this},r.prototype.setId=function(t){var e=this.state,r=this.elements,n=r.length;if(e.id=t||he(!!n),n&&!e[zt]){var i=le(this.getId());e[zt]="[".concat(ct,'="').concat(i,'"]'),r.forEach((function(t){t.setAttribute(ct,i)}))}return this},r.prototype.set=function(t){for(var e=this,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(ye(t))return this.set(0,t);if(w(t))for(var o=t.length,a=0;a<o;++a){var s=1===o?0:this.getUnitTime("".concat(a/(o-1)*100,"%"));this.set(s,t[a])}else if(T(t)){var u=function(r){var i=t[r];F(r).forEach((function(t){var r=e.getUnitTime(t);isNaN(r)?ee(i,[t]).forEach((function(t){for(var r,o=ie(t.slice(1),i),a=w(o)?o:[ie(t,e.target),o],s=a.length,u=0;u<s;++u)(r=e.newFrame("".concat(u/(s-1)*100,"%"))).set.apply(r,n(n([],t,!1),[a[u]],!1))})):e.set(r,i)}))};for(var s in t)u(s)}else if(!S(t)){var c=r[0];F(t+"").forEach((function(t){var n=e.getUnitTime(t);if(ye(c)){var i=c.getDelay(),o=c.toObject(!e.hasFrame(n+i)),a=c.getDuration(),s=c.getDirection().indexOf("reverse")>-1;for(var u in o){var f=s?a-parseFloat(u):parseFloat(u);e.set(n+f,o[u])}}else if(1===r.length&&w(c))c.forEach((function(t){e.set(n,t)}));else{var h=e.newFrame(n);h.set.apply(h,r)}}))}return this.needUpdate=!0,this},r.prototype.get=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=this.getFrame(t);return n&&n.get.apply(n,e)},r.prototype.getOrders=function(t){return this.needUpdate&&this.update(),this.nameMap.get(t)},r.prototype.setOrders=function(t,e){this.needUpdate&&this.update();var r=this.nameMap.set(t,e);return this.updateFrameOrders(),r},r.prototype.getOrderObject=function(){return this.nameMap.getObject()},r.prototype.setOrderObject=function(t){this.nameMap.setObject(t),this.updateFrameOrders()},r.prototype.remove=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(e.length){var n=this.getFrame(t);n&&n.remove.apply(n,e)}else this.removeFrame(t);return this.needUpdate=!0,this},r.prototype.append=function(t){return ye(t)?this.set(this.getDuration(),t):this.append(new r(t)),this},r.prototype.prepend=function(t){if(ye(t)){var e=t.getDuration()+t.getDelay(),n=this.getFrame(0);this.removeFrame(0),this.unshift(e),this.set(0,t),this.set(e+dt,n)}else this.prepend(new r(t));return this},r.prototype.unshift=function(t){var e=this.times,r=this.items,n={};return this.times=e.map((function(e){var i=ne(t+e);return n[i]=r[e],i})),this.items=n,this},r.prototype.toObject=function(t){void 0===t&&(t=!0);var e={},r=this.getDelay();return this.forEach((function(n,i){e[(i||t?0:dt)+r+i]=n.clone()})),e},r.prototype.setSelector=function(t){return this.setElement(t),this},r.prototype.getElements=function(){return this.elements},r.prototype.setElements=function(t){return this.setElement(t)},r.prototype.setElement=function(t){!0!==t&&this.registeredElement!==t&&(this.registeredElement=t);var e,r=this.state,n=this.registeredElement,i=[];if(x(n)&&n(this.getId(),0),!t)return this;if(!0===t||C(t)){var o=C(r[zt])&&r[zt]||"".concat(r.id),a=!0===t?o:t,s=/([\s\S]+)(:+[a-zA-Z]+)$/g.exec(a);try{i=P(K(s?s[1]:a,!0))}catch(t){i=[]}r[zt]=a}else if("length"in(e=t)&&e.length>=0)i=P(t);else if(t instanceof Element)i=[t];else if("current"in t||"value"in t){var u=t.current||t.value;i=u?[u]:[]}return i.length?(this.elements=i,this.setId(this.getId()),this.target=i[0].style,this.targetFunc=function(t){var e=t.get("attribute");if(e){var n=function(t){i.forEach((function(r){r.setAttribute(t,e[t])}))};for(var o in e)n(o)}if(t.has("html")){var a=t.get("html");i.forEach((function(t){t.innerHTML=a}))}var s=t.toCSSText();if(r.cssText!==s)return r.cssText=s,i.forEach((function(t){t.style.cssText+=s})),t},this):this},r.prototype.setTarget=function(t){return this.target=t,this.targetFunc=function(e){var r=e.get();for(var n in r)t[n]=r[n]},this},r.prototype.setCSS=function(t,e){return void 0===e&&(e=[]),this.set(t,function(t,e){if(!t||!e||!e.length)return{};var r;if(t instanceof Element)r=t;else{if(!t.length)return{};r=t[0]}for(var n={},i=window.getComputedStyle(r),o=e.length,a=0;a<o;++a)n[e[a]]=i[e[a]];return n}(this.elements,e)),this},r.prototype.setTime=function(e,r,n,i){var o=this;return t.prototype.setTime.call(this,e,r,n,(function(){var t=o.getIterationTime(),e=o.getEasing()||i,r=o.getNowFrame(t,e),n=o.getTime();o.temp=r,o.trigger("animate",{frame:r,currentTime:n,time:t}),o.targetFunc&&o.targetFunc(r)})),this},r.prototype.update=function(){var t=this.nameMap,e={};this.forEach((function(t){re(e,t.properties)}));var r=new Qe($t);return function e(i,o){var a=L(i);B(a,t.get(o)),r.set(o,a),a.forEach((function(t){var r=i[t];T(r)&&e(r,n(n([],o,!0),[t],!1))}))}(e,[]),this.nameMap=r,this.forEach((function(t){t.setOrderObject(r.orderMap)})),this.needUpdate=!1,this},r.prototype.newFrame=function(t){var e=this.getFrame(t);return e||(e=new or,this.setFrame(t,e),e)},r.prototype.setFrame=function(t,e){var r=this.getUnitTime(t);return this.items[r]=e,function(t,e){for(var r=t.length,n=0;n<r;++n)if(e<t[n])return void t.splice(n,0,e);t[r]=e}(this.times,r),this.needUpdate=!0,this},r.prototype.getFrame=function(t){return this.items[this.getUnitTime(t)]},r.prototype.removeFrame=function(t){var e=this.getUnitTime(t),r=this.items,n=this.times.indexOf(e);return delete r[e],n>-1&&this.times.splice(n,1),this.needUpdate=!0,this},r.prototype.hasFrame=function(t){return this.getUnitTime(t)in this.items},r.prototype.hasName=function(t){return this.needUpdate&&this.update(),!!this.nameMap.get(t)},r.prototype.mergeFrame=function(t,e){e&&this.newFrame(t).merge(e);return this},r.prototype.getNowFrame=function(t,e,r){var n=this;this.needUpdate&&this.update();var i=new or,o=pr(this.times,t),a=o[0],s=o[1],u=this.getEasing()||e,c=this.nameMap;if(this.hasName([ft])){var f=this.getNowValue(t,[ft],a,s,!1,0,!0);x(f)&&(u=f)}if(r){var h=this.getFrame(t),p=h.orderMap.filter([],(function(t){return h.has.apply(h,t)}));for(var l in ht){var v=c.get([l]);p.get([l])&&v&&p.set([l],v)}c=p}var d=c.gets([]);return i.setOrderObject(c.orderMap),d.forEach((function(e){var o=n.getNowValue(t,e,a,s,r,u,se(e));S(o)||i.set(e,o)})),i},r.prototype.getCurrentFrame=function(t,e){var r=this.getIterationTime(),n=t||this.needUpdate||!this.temp?this.getComputedFrame(r,e):this.temp;return this.temp=n,n},r.prototype.getComputedFrame=function(t,e,r){return this.getNowFrame(t,e,r)},r.prototype.load=function(t,e){var r;if(void 0===t&&(t={}),void 0===e&&(e=t.options),e&&this.setOptions(e),w(t))this.set(t);else if(t.keyframes)this.set(t.keyframes);else for(var n in t)"options"!==n&&this.set(((r={})[n]=t[n],r));return e&&e[mt]&&this.setDuration(e[mt]),this},r.prototype.clone=function(){var t=new r;return t.setOptions(this.state),t.setOrderObject(this.nameMap.orderMap),this.forEach((function(e,r){t.setFrame(r,e.clone())})),t},r.prototype.forEach=function(t){var e=this.times,r=this.items;return e.forEach((function(e){t(r[e],e,r)})),this},r.prototype.setOptions=function(e){void 0===e&&(e={}),t.prototype.setOptions.call(this,e);var r=e.id,n=e.selector,i=e.elements,o=e.element,a=e.target;return r&&this.setId(r),a?this.setTarget(a):n&&!this.state.noRegisterElement?this.setSelector(n):(i||o)&&this.setElement(i||o),this},r.prototype.toCSS=function(t,e,r){void 0===t&&(t={className:It}),void 0===e&&(e=this.getDuration()),void 0===r&&(r=[]);var n=this.state,i=n[zt];if(!i)return"";var o=this.getDuration();n[mt]=o,r.push(n);var a=P(r).reverse(),s=le(pe(this)),u=r[0],c=k(a,(function(t){return t[Et]===Rt||!isFinite(t[mt])}),r.length-1),f=a.slice(0,c),h=e||f.reduce((function(t,e){return(e[_t]+t*e[Et])/e[Ot]}),o),p=a.slice(c).reduce((function(t,e){return(t+e[_t])/e[Ot]}),0),l=V(a,(function(t){return t[bt]&&t[St]}),n)[St],v=a[c][Et],d=u[gt],m=a[c][yt],g=lr({fillMode:d,direction:m,iterationCount:v,delay:"".concat(p,"s"),name:"".concat(ut,"KEYFRAMES_").concat(s),duration:"".concat(h/u[Ot],"s"),timingFunction:l}),y=F(i).map((function(t){var e=/([\s\S]+)(:+[a-zA-Z]+)$/g.exec(t);return e?[e[1],e[2]]:[t,""]})),b=t.className,O=t.selector,S=x(O)?O(this,i):O;return"\n    ".concat(S||y.map((function(t){var e=t[0],r=t[1];return"".concat(e,".").concat(b).concat(r)}))," {").concat(g,"}\n    ").concat(y.map((function(t){var e=t[0],r=t[1];return"".concat(e,".").concat(Ft).concat(r)}))," {").concat(E,"-play-state: paused;}\n    @").concat(_," ").concat(ut,"KEYFRAMES_").concat(s,"{").concat(this._toKeyframes(h,f,m),"}")},r.prototype.exportCSS=function(t,e,r){if(!this.elements.length)return"";var n=this.toCSS(t,e,r);return r&&!S(r[Et])||(this.styledInjector&&(this.styledInjector.destroy(),this.styledInjector=null),this.styled=hr(n),this.styledInjector=this.styled.inject(this.getAnimationElement(),{original:!0})),this},r.prototype.pause=function(){return t.prototype.pause.call(this),ce(this)&&this.pauseCSS(),this},r.prototype.pauseCSS=function(){return this.elements.forEach((function(t){Z(t,Ft)})),this},r.prototype.endCSS=function(){return this.elements.forEach((function(t){W(t,Ft),W(t,It)})),ue(this,!1),this},r.prototype.end=function(){return fe(this)&&this.endCSS(),t.prototype.end.call(this),this},r.prototype.playCSS=function(t,e,r){return void 0===t&&(t=!0),void 0===r&&(r={}),ve(this,t,e,r),this},r.prototype.getAnimationElement=function(){return this.elements[0]},r.prototype.addPlayClass=function(t,e,r){void 0===r&&(r={});var n=this.elements,i=n.length,o=lr(r);if(i)return t?n.forEach((function(t){W(t,Ft)})):(n.forEach((function(t){t.style.cssText+=o,function(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}(t,It)&&W(t,It)})),n.forEach((function(t){t.clientWidth})),n.forEach((function(t){Z(t,It)}))),n[0]},r.prototype.clear=function(){return this.times=[],this.items={},this.nameMap=new Qe($t),this.styledInjector&&this.styledInjector.destroy(),this.styled=null,this.styledInjector=null,this.temp=null,this.needUpdate=!0,this},r.prototype.getNowValue=function(t,e,r,n,i,o,a){var s,u,c,f,h=this.times,p=h.length,l=S(r),v=S(n);if(l||v){var d=pr(h,t);l&&(r=d[0]),v&&(n=d[1])}for(var m=r;m>=0;--m){if((y=this.getFrame(h[m])).has.apply(y,e)){s=h[m],c=y;break}}var g=c&&c.raw.apply(c,e);if(i&&!ae([e[0]]))return s===t?g:void 0;if(a)return g;for(m=n;m<p;++m){var y;if((y=this.getFrame(h[m])).has.apply(y,e)){u=h[m],f=y;break}}var E=f&&f.raw.apply(f,e);return!c||S(g)?E:!f||S(E)||g===E?g:function(t,e,r,n,i,o){if(t===e)return n;if(t===r)return i;if(!o)return ur(n,i,t-e,r-t);var a=o((t-e)/(r-e));return ur(n,i,a,1-a)}(t,Math.max(s,0),u,g,E,o)},r.prototype._toKeyframes=function(t,e,r){var n=this,i={},o=this.times.slice();if(!o.length)return"";var a=this.getDuration();!this.getFrame(0)&&o.unshift(0),!this.getFrame(a)&&o.push(a);var s=function(t,e){var r=t.map((function(t){return[t,t]})),n=[];return e.forEach((function(t){for(var e=t[Et],i=t[_t],o=t[Ot],a=t[yt],s=Math.ceil(e),u=r[r.length-1][0],c=r.length,f=u*e,h=0;h<s;++h)for(var p=a===Dt||a===At&&h%2||a===Nt&&!(h%2),l=0;l<c;++l){var v=r[p?c-l-1:l],d=v[1],m=u*h+(p?u-v[0]:v[0]),g=r[p?c-l:l-1];if(m>f){if(0!==l){var y=u*h+(p?u-g[0]:g[0]),E=O(g[1],d,f-y,m-f);vr(n,(i+u*e)/o,E)}break}if(m===f&&n.length&&n[n.length-1][0]===f+i)break;vr(n,(i+m)/o,d)}i&&n.unshift([0,n[0][1]]),r=n,n=[]})),r}(o,e),u=s[s.length-1];u[0]<t&&vr(s,t,u[1]);var c=-1;return s.map((function(e){var o=e[0],s=e[1];i[s]||(i[s]=(n.hasFrame(s)&&0!==s&&s!==a?n.getNowFrame(s,0,!0):n.getNowFrame(s)).toCSSText());var u=o/t*100;return u-c<dt&&(u+=dt),c=u,"".concat(Math.min(u,100),"%{\n                ").concat(0!==o||We(0,1,r)?i[s]:"","\n            }")})).join("")},r.prototype.updateFrameOrders=function(){var t=this.nameMap.orderMap;this.forEach((function(e){e.setOrderObject(t)}))},r}(Xe),mr=function(t){function r(e,r){var n=t.call(this)||this;return n.items={},n.orderMap=new Qe($t),n.load(e,r),n}return e(r,t),r.prototype.getDuration=function(){var t=0;return this.forEach((function(e){t=Math.max(t,e.getTotalDuration()/e.getPlaySpeed())})),t||this.state[mt]},r.prototype.setDuration=function(e){this.items;var r=this.getDuration();if(0===e||!isFinite(r))return this;if(0===r)this.forEach((function(t){t.setDuration(e)}));else{var n=e/r;this.forEach((function(t){t.setDelay(t.getDelay()*n),t.setDuration(t.getDuration()*n)}))}return t.prototype.setDuration.call(this,e),this},r.prototype.getItem=function(t){return this.items[t]},r.prototype.newItem=function(t,e){if(void 0===e&&(e={}),this.items[t])return this.items[t];var r=new dr;return this.setItem(t,r),r.setOptions(e),r},r.prototype.removeItem=function(t){return delete this.items[t],this.orderMap.remove([t]),this},r.prototype.setItem=function(t,e){return e.setId(t),this.items[t]=e,this.orderMap.add([t]),this},r.prototype.getCurrentFrames=function(t,e){var r=this.getEasing()||e,n={};return this.forEach((function(e){var i=e.getId();ge(e)?n[i]=e.getCurrentFrames(t,r):n[i]=e.getCurrentFrame(t,r)})),this.temp=n,n},r.prototype.getCurrentFlattedFrames=function(t,e){return _e(this.getCurrentFrames(t,e),$t)},r.prototype.setTime=function(e,r,n,i){var o=this;return t.prototype.setTime.call(this,e,r,n,(function(){var t=o.getIterationTime(),e=o.getEasing()||i;o.forEach((function(n){n.setTime(t*n.getPlaySpeed()-n.getDelay(),r,!0,e)}));var n=o.getCurrentFrames(!1,i);o.trigger("animate",{frames:n,currentTime:o.getTime(),time:t})})),this},r.prototype.forEach=function(t){var e=this.items;return this.getOrders().forEach((function(r,n){t(e[r],r,n,e)})),this},r.prototype.toCSS=function(t,e,r){void 0===e&&(e=this.getDuration()),void 0===r&&(r=[]);var n=e&&isFinite(e)?e:0,i=[],o=this.state;return o[mt]=this.getDuration(),this.forEach((function(e){i.push(e.toCSS(t,n,r.concat(o)))})),i.join("")},r.prototype.exportCSS=function(t,e,r){var n=this.toCSS(t,e,r);return r&&r.length||(this.styledInjector&&(this.styledInjector.destroy(),this.styledInjector=null),this.styled=hr(n),this.styledInjector=this.styled.inject(this.getAnimationElement(),{original:!0})),this},r.prototype.append=function(t){t.setDelay(t.getDelay()+this.getDuration()),this.setItem(pe(t),t)},r.prototype.pauseCSS=function(){return this.forEach((function(t){t.pauseCSS()}))},r.prototype.pause=function(){return t.prototype.pause.call(this),ce(this)&&this.pauseCSS(),this.forEach((function(t){t.pause()})),this},r.prototype.endCSS=function(){this.forEach((function(t){t.endCSS()})),ue(this,!1)},r.prototype.end=function(){return fe(this)&&this.endCSS(),t.prototype.end.call(this),this},r.prototype.getOrders=function(){return this.orderMap.get([])||[]},r.prototype.setOrders=function(t){return this.orderMap.set([],t)},r.prototype.getAnimationElement=function(){var t;return this.forEach((function(e){var r=e.getAnimationElement();!t&&(t=r)})),t},r.prototype.addPlayClass=function(t,e,r){var n;return void 0===r&&(r={}),this.forEach((function(i){var o=i.addPlayClass(t,e,r);!n&&(n=o)})),n},r.prototype.playCSS=function(t,e,r){return void 0===t&&(t=!0),void 0===r&&(r={}),ve(this,t,e,r),this},r.prototype.set=function(t){return this.load(t),this},r.prototype.clear=function(){this.finish(),this.items={},this.orderMap=new Qe($t),this.styledInjector&&this.styledInjector.destroy(),this.styled=null,this.styledInjector=null},r.prototype.load=function(t,e){if(void 0===t&&(t={}),void 0===e&&(e=t.options),!t)return this;this.setOptions(e);var n=e&&e[zt]||this.state[zt],i=function(e){if("options"===e)return"continue";var i=t[e],a=void 0;if(ge(i)||ye(i))o.setItem(e,i),a=i;else{if(x(i)){var s=[];n&&l&&(o.state.noRegisterElement||(s=K("".concat(x(n)?n(e):e),!0)));for(var u=s.length,c=u||i.defaultCount||0,f=new r,h=[],p=0;p<c;++p){var v=s[p],d=f.newItem(p);d.setId().load(i(p,s[p])),h.push(d.getId()),v&&d.setElement(v)}if(!u){var m=[];f.state[zt]=function(t){return m.length||(m=K("".concat(x(n)?n(e):e),!0)),m[h.indexOf(t)]}}return o.setItem(e,f),"continue"}(a=o.newItem(e,{noRegisterElement:!0})).load(i)}o.state.noRegisterElement||n&&a.setSelector(n)},o=this;for(var a in t)i(a)},r.prototype.setOptions=function(e){void 0===e&&(e={}),t.prototype.setOptions.call(this,e);var r=e.selector;return r&&(this.state[zt]=r),this},r.prototype.setSelector=function(t){var e=this.state,r=!0===t?e[zt]||!0:t;e[zt]=r;var n=x(t);return r&&this.forEach((function(e,i){e.setSelector(n?t(i):r)})),this},r.prototype.start=function(e){void 0===e&&(e=this.state[_t]);var r=t.prototype.start.call(this,e);return r?this.forEach((function(t){t.start(0)})):this.forEach((function(t){t.setPlayState(Mt)})),r},r.VERSION="1.10.0",r}(Xe);function gr(t){var e=t.prototype;return L(e).filter((function(t){var r=Object.getOwnPropertyDescriptor(e,t);return"constructor"!==t&&(!r.get&&!r.set&&x(r.value||e[t]))}))}var yr=n(n([],gr(Te),!0),gr(Xe),!0),Er=n(n([],yr,!0),gr(mr),!0),_r={methods:Er,created:function(t){var e=t.props,i=x(e)?e():e,o=ge(i)?i:new mr(i,r({noRegisterElement:!1},t.options)),a=$e(o.state),s=Le((function(){return o.getTotalDuration()})),u=r(r(r({totalDuration:s},a),Er.reduce((function(t,e){return t[e]=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return(t=o[e]).call.apply(t,n([o],r,!1))},t}),{})),{getInstance:function(){return o}});return He(u)},mounted:function(t,e){var r=e.getInstance().state,n=r.selector;n&&!r.__REACTIVE_MOUNTED__&&(e.setSelector(n),r.__REACTIVE_MOUNTED__=!0,e.forEach((function t(e){var r=e.state;r.selector&&(r.__REACTIVE_MOUNTED__=!0),ge(e)&&e.forEach(t)})))},on:function(t,e,r){t.on(e,r)},off:function(t,e,r){t.off(e,r)},destroy:function(t){t.getInstance().state.__REACTIVE_MOUNTED__=!1,t.forEach((function t(e){e.state.__REACTIVE_MOUNTED__=!1,ge(e)&&e.forEach(t)}))}},br=n(n([],yr,!0),gr(mr),!0),Or={methods:br,created:function(t){var e=t.props,i=x(e)?e():e,o=ye(i)?i:new dr(i,r({noRegisterElement:!1},t.options)),a=$e(o.state),s=Le((function(){return o.getTotalDuration()})),u=r(r(r({totalDuration:s},a),br.reduce((function(t,e){return t[e]=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];return(t=o[e]).call.apply(t,n([o],r,!1))},t}),{})),{getInstance:function(){return o}});return He(u)},mounted:function(t,e){var r=e.getInstance().state,n=r.selector;n&&!r.__REACTIVE_MOUNTED__&&(e.setSelector(n),r.__REACTIVE_MOUNTED__=!0)},on:function(t,e,r){t.on(e,r)},off:function(t,e,r){t.off(e,r)},destroy:function(t){t.getInstance().state.__REACTIVE_MOUNTED__=!1,t.finish()}},Sr=n(n([],yr,!0),gr(or),!0),Tr={methods:Sr,created:function(t){var e,i=x(t)?t():t,o=ze(0);e=Ze(i)?i:ze(Ee(i)?i:new or(i));var a=Le((function(){return e.current,o.current,e.current.toCSSText()})),s=Le((function(){return e.current,a.current,e.current.toCSSObject()})),u=Le((function(){return e.current,a.current,e.current.toCSSObject(!0)})),c=function(){++o.current};e.subscribe((function(t,e){e.off("update",c),t.on("update",c)}));var f=He(r({cssText:a,cssObject:s,camelCasedCSSObject:u,onUpdate:c},Sr.reduce((function(t,r){return t[r]=function(){for(var t,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var a=e.current;return null==a?void 0:(t=a[r]).call.apply(t,n([a],i,!1))},t}),{})));return f},destroy:function(t){t.off("update",t.onUpdate)}},wr=r(r({},Tr),{created:function(t){var e=x(t)?t():t,r=ze(new or);return e.on("animate",(function(t){r.current=t.frame})),Tr.created(r)}}),Cr={__proto__:null,Scene:mr,SceneItem:dr,Frame:or,Animator:Xe,default:mr,OPTIONS:qt,EVENTS:Kt,FIXED:lt,ROLES:ht,NAME_SEPARATOR:$t,setRole:function(t,e,r){for(var n=t.length,i=ht,o=lt,a=0;a<n-1;++a)!i[t[a]]&&(i[t[a]]={}),i=i[t[a]],r&&(!o[t[a]]&&(o[t[a]]={}),o=o[t[a]]);r&&(o[t[n-1]]=!0),i[t[n-1]]=!!e||{}},setAlias:function(t,e){pt[t]=e},isRole:ae,isScene:ge,isSceneItem:ye,isAnimator:function(t){return t&&!!t.constructor.prototype.getActiveDuration},isFrame:Ee,selectorAll:function(t,e){void 0===e&&(e=0);var r=t.bind({});return r.defaultCount=e,r},rgbaToHexWithOpacity:be,rgbaToHexa:function(t){var e=be(t),r=e.hex;if(!e.hex)return"";var n=Math.floor(255*e.opacity).toString(16);return"".concat(r).concat(n)},bezier:G,steps:Q,STEP_START:et,STEP_END:rt,LINEAR:nt,EASE:it,EASE_IN:ot,EASE_OUT:at,EASE_IN_OUT:st,animate:function(t,e){return new mr(t,e).play()},animateItem:function(t,e){return new dr(t,e).play()},getMethodNames:gr,ANIMATOR_METHODS:yr,SCENE_METHODS:Er,SCENE_REACTIVE:_r,SCENE_ITEM_METHODS:br,SCENE_ITEM_REACTIVE:Or,FRAME_METHODS:Sr,FRAME_REACTIVE:Tr,NOW_FRAME_REACTIVE:wr};for(var xr in Cr)mr[xr]=Cr[xr];return mr}));
//# sourceMappingURL=scene.min.js.map
